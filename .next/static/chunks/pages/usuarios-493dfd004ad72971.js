(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[361],{9548:function(e,a,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/usuarios",function(){return s(8966)}])},1727:function(e,a,s){"use strict";s.d(a,{Z:function(){return TopNav}});var t=s(5893),r=s(1664),n=s.n(r),l=s(1163),i=s(169);function TopNav(){let e=(0,l.useRouter)(),{user:a,logout:s}=(0,i.aC)();if(!a)return null;let r=[{href:"/dashboard",label:"Dashboard"},{href:"/articles",label:"Artigos"},{href:"/entrada",label:"Entrada"},{href:"/saida",label:"Sa\xedda"},{href:"/estoque",label:"Estoque"},{href:"/contagem",label:"Contagem"},{href:"/usuarios",label:"Usu\xe1rios"}];return(0,t.jsxs)("header",{className:"header sticky top-0 z-40 shadow-sm",children:[(0,t.jsxs)("div",{className:"max-w-5xl mx-auto flex items-center justify-between p-3",children:[(0,t.jsx)("div",{className:"flex items-center gap-4",children:(0,t.jsx)("img",{src:"/srj-logo.svg",alt:"SRJ",width:"140"})}),(0,t.jsx)("nav",{className:"hidden md:flex gap-2",children:r.map(a=>{let s=e.pathname===a.href;return(0,t.jsx)(n(),{href:a.href,children:(0,t.jsx)("div",{className:"nav-tab ".concat(s?"nav-tab-active":""),children:a.label})},a.href)})}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["Ol\xe1, ",null==a?void 0:a.username]}),(0,t.jsx)("button",{onClick:()=>{s()},className:"bg-brand-500 text-white px-3 py-1 rounded no-print",children:"Sair"})]})]}),(0,t.jsx)("div",{className:"md:hidden overflow-auto",children:(0,t.jsx)("div",{className:"flex gap-2 px-3 pb-2",children:r.map(e=>(0,t.jsx)(n(),{href:e.href,children:(0,t.jsx)("div",{className:"nav-tab",children:e.label})},e.href))})})]})}},8966:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return Usuarios}});var t=s(5893),r=s(6976),n=s(7294),l=s(1727);let f=e=>fetch(e).then(e=>e.json());function getToken(){try{let e=localStorage.getItem("estoque_srj_user");if(!e)return null;return JSON.parse(e).token}catch(e){return null}}function Usuarios(){let{data:e,mutate:a}=(0,r.ZP)("/api/users",f),[s,i]=(0,n.useState)(""),[d,o]=(0,n.useState)(""),[u,c]=(0,n.useState)(""),[h,m]=(0,n.useState)("usuario"),[x,p]=(0,n.useState)(null);(0,n.useEffect)(()=>{(async()=>{let e=await fetch("/api/users/me",{headers:{Authorization:"Bearer "+getToken()}});if(e.ok){let a=await e.json();p(a.role)}})()},[]);let add=async()=>{await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:s,name:d,password:u,role:h})}),i(""),o(""),c(""),m("usuario"),a()},remove=async e=>{if(!confirm("Excluir usu\xe1rio?"))return;let s=getToken();if(!s)return alert("Sem permiss\xe3o");let t=await fetch("/api/users/"+encodeURIComponent(e),{method:"DELETE",headers:{Authorization:"Bearer "+s}});if(t.ok)a();else{let e=await t.text();alert("Erro: "+e)}};return(0,t.jsxs)("div",{className:"min-h-screen",children:[(0,t.jsx)(l.Z,{}),(0,t.jsxs)("main",{className:"max-w-5xl mx-auto p-4",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-brand-500",children:"Usu\xe1rios"}),(0,t.jsxs)("div",{className:"mt-4 p-4 bg-white rounded shadow",children:[(0,t.jsx)("input",{value:s,onChange:e=>i(e.target.value),placeholder:"Login",className:"w-full border p-2 rounded mb-2"}),(0,t.jsx)("input",{value:d,onChange:e=>o(e.target.value),placeholder:"Nome",className:"w-full border p-2 rounded mb-2"}),(0,t.jsx)("input",{value:u,onChange:e=>c(e.target.value),placeholder:"Senha",className:"w-full border p-2 rounded mb-2"}),(0,t.jsxs)("select",{value:h,onChange:e=>m(e.target.value),className:"w-full border p-2 rounded mb-2",children:[(0,t.jsx)("option",{value:"usuario",children:"Usu\xe1rio"}),(0,t.jsx)("option",{value:"admin",children:"Admin"})]}),(0,t.jsx)("button",{onClick:add,className:"bg-brand-500 text-white rounded p-2",children:"Adicionar Usu\xe1rio"})]}),(0,t.jsx)("div",{className:"mt-4 bg-white p-4 rounded shadow",children:null==e?void 0:e.map(e=>(0,t.jsxs)("div",{className:"p-2 border-b flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"font-medium",children:[e.name," ",(0,t.jsxs)("span",{className:"text-xs text-gray-400",children:["(",e.username,")"]})]}),(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:["Perfil: ",e.role]})]}),(0,t.jsxs)("div",{className:"text-sm flex items-center gap-2",children:["admin"===x&&"admin"!==e.username&&(0,t.jsx)("button",{onClick:()=>remove(e.username),className:"text-red-600",children:"Excluir"}),(0,t.jsx)("div",{className:"text-xs text-gray-400",children:e.username})]})]},e.username))})]})]})}}},function(e){e.O(0,[664,976,774,888,179],function(){return e(e.s=9548)}),_N_E=e.O()}]);