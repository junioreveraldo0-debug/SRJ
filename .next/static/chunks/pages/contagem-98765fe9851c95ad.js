(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[775],{4486:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/contagem",function(){return a(7363)}])},1727:function(e,t,a){"use strict";a.d(t,{Z:function(){return TopNav}});var s=a(5893),l=a(1664),d=a.n(l),n=a(1163),r=a(169);function TopNav(){let e=(0,n.useRouter)(),{user:t,logout:a}=(0,r.aC)();if(!t)return null;let l=[{href:"/dashboard",label:"Dashboard"},{href:"/articles",label:"Artigos"},{href:"/entrada",label:"Entrada"},{href:"/saida",label:"Sa\xedda"},{href:"/estoque",label:"Estoque"},{href:"/contagem",label:"Contagem"},{href:"/usuarios",label:"Usu\xe1rios"}];return(0,s.jsxs)("header",{className:"header sticky top-0 z-40 shadow-sm",children:[(0,s.jsxs)("div",{className:"max-w-5xl mx-auto flex items-center justify-between p-3",children:[(0,s.jsx)("div",{className:"flex items-center gap-4",children:(0,s.jsx)("img",{src:"/srj-logo.svg",alt:"SRJ",width:"140"})}),(0,s.jsx)("nav",{className:"hidden md:flex gap-2",children:l.map(t=>{let a=e.pathname===t.href;return(0,s.jsx)(d(),{href:t.href,children:(0,s.jsx)("div",{className:"nav-tab ".concat(a?"nav-tab-active":""),children:t.label})},t.href)})}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:["Ol\xe1, ",null==t?void 0:t.username]}),(0,s.jsx)("button",{onClick:()=>{a()},className:"bg-brand-500 text-white px-3 py-1 rounded no-print",children:"Sair"})]})]}),(0,s.jsx)("div",{className:"md:hidden overflow-auto",children:(0,s.jsx)("div",{className:"flex gap-2 px-3 pb-2",children:l.map(e=>(0,s.jsx)(d(),{href:e.href,children:(0,s.jsx)("div",{className:"nav-tab",children:e.label})},e.href))})})]})}},7363:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Contagem}});var s=a(5893),l=a(7294),d=a(1727);function Contagem(){let[e,t]=(0,l.useState)(""),[a,n]=(0,l.useState)([]),[r,i]=(0,l.useState)(""),add=async()=>{if(!e)return i("Informe c\xf3digo");let a=await fetch("/api/rolls?barcode="+encodeURIComponent(e));if(!a.ok)return i("Rolo n\xe3o encontrado");let s=await a.json();n(e=>[...e,s]),t(""),i("Rolo adicionado: "+s.id)},o=(0,l.useMemo)(()=>{let e={};return a.forEach(t=>{let a=t.article_id||"unknown";e[a]||(e[a]={articleName:t.articleName||"",width:t.width||"",count:0,total:0}),e[a].count+=1,e[a].total+=Number(t.remaining_quantity||0)}),Object.values(e)},[a]);return(0,s.jsxs)("div",{className:"min-h-screen",children:[(0,s.jsx)(d.Z,{}),(0,s.jsxs)("main",{className:"max-w-5xl mx-auto p-4",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-brand-500",children:"Contagem de Estoque"}),(0,s.jsxs)("div",{className:"mt-4 p-4 bg-white rounded shadow space-y-2",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{value:e,onChange:e=>t(e.target.value),placeholder:"Inserir/escaneie c\xf3digo do rolo",className:"flex-1 border p-2 rounded"}),(0,s.jsx)("button",{onClick:add,className:"bg-brand-500 text-white p-2 rounded",children:"Adicionar"})]}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:r})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("h3",{className:"font-semibold",children:"Resumo por Artigo"}),(0,s.jsx)("div",{className:"mt-2 bg-white rounded shadow overflow-hidden",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"text-left p-2",children:"Artigo"}),(0,s.jsx)("th",{className:"text-left p-2",children:"Largura"}),(0,s.jsx)("th",{className:"text-left p-2",children:"Qtd"}),(0,s.jsx)("th",{className:"text-left p-2",children:"Metragem"})]})}),(0,s.jsx)("tbody",{children:o.map((e,t)=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"p-2",children:e.articleName}),(0,s.jsx)("td",{className:"p-2",children:e.width}),(0,s.jsx)("td",{className:"p-2",children:e.count}),(0,s.jsx)("td",{className:"p-2",children:e.total})]},t))})]})})]}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)("button",{onClick:()=>{let e=window.open("","_blank");e.document.write("<html><head><title>Contagem - SRJ</title><style>body{font-family:Arial;margin:20px} .header{display:flex;justify-content:space-between;align-items:center} table{width:100%;border-collapse:collapse} th{background:#e6f0ff;padding:8px;text-align:left} td{padding:8px;border-bottom:1px solid #eee}</style></head><body>"),e.document.write('<div class="header"><div><img src="/srj-logo.svg" width="140"/></div><div>Emitido em: '+new Date().toLocaleString()+"</div></div>"),e.document.write("<h2>Contagem de Estoque</h2>"),e.document.write("<table><thead><tr><th>Artigo</th><th>Largura (cm)</th><th>Qtd. de rolos</th><th>Metragem total (m)</th></tr></thead><tbody>"),o.forEach(t=>{e.document.write("<tr><td>"+t.articleName+"</td><td>"+t.width+"</td><td>"+t.count+"</td><td>"+t.total+"</td></tr>")}),e.document.write("</tbody></table></body></html>"),e.document.close(),e.print(),e.onafterprint=()=>e.close()},className:"bg-brand-500 text-white p-2 rounded",children:"Imprimir Contagem"})})]})]})}}},function(e){e.O(0,[664,774,888,179],function(){return e(e.s=4486)}),_N_E=e.O()}]);