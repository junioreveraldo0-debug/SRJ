"use strict";(()=>{var e={};e.id=771,e.ids=[771],e.modules={9344:e=>{e.exports=require("jsonwebtoken")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},1721:e=>{e.exports=import("@upstash/redis")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},8693:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{config:()=>u,default:()=>o,routeModule:()=>c});var i=a(1802),s=a(7153),n=a(6249),d=a(9823),l=e([d]);d=(l.then?(await l)():l)[0];let o=(0,n.l)(d,"default"),u=(0,n.l)(d,"config"),c=new i.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/articles/[id]",pathname:"/api/articles/[id]",bundlePath:"",filename:""},userland:d});r()}catch(e){r(e)}})},9823:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{default:()=>handler});var i=a(3924),s=a(9344),n=a.n(s),d=e([i]);async function handler(e,t){let a=e.query.id;if("DELETE"===e.method){let r=e.headers.authorization||"";if(!r.startsWith("Bearer "))return t.status(401).send("Unauthorized");let s=r.split(" ")[1];try{let e=n().verify(s,process.env.JWT_SECRET||"devsecret"),a=await (0,i.c)("users"),r=a.find(t=>t.username===e.username);if(!r||"admin"!==r.role)return t.status(403).send("Forbidden")}catch(e){return t.status(401).send("Invalid token")}let d=await (0,i.c)("artigos"),l=d.filter(e=>e.id!==a);await (0,i.P)("artigos",l);let o=await (0,i.c)("rolls"),u=o.filter(e=>e.article_id!==a);await (0,i.P)("rolls",u);let c=await (0,i.c)("movements"),p=c.filter(e=>e.article_id!==a);return await (0,i.P)("movements",p),t.json({ok:!0})}t.status(405).end()}i=(d.then?(await d)():d)[0],r()}catch(e){r(e)}})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[222,924],()=>__webpack_exec__(8693));module.exports=a})();