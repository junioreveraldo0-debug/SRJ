"use strict";(()=>{var e={};e.id=257,e.ids=[257],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},1721:e=>{e.exports=import("@upstash/redis")},6555:e=>{e.exports=import("uuid")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},3027:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{config:()=>d,default:()=>l,routeModule:()=>c});var i=r(1802),s=r(7153),n=r(6249),o=r(6281),u=e([o]);o=(u.then?(await u)():u)[0];let l=(0,n.l)(o,"default"),d=(0,n.l)(o,"config"),c=new i.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/rolls",pathname:"/api/rolls",bundlePath:"",filename:""},userland:o});a()}catch(e){a(e)}})},6281:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>handler});var i=r(6555),s=r(3924),n=e([i,s]);async function handler(e,t){try{if("POST"===e.method){let{article_id:r,initial_quantity:a,lot_number:n,location:o,nuance:u}=e.body;if(!r||null==a)return t.status(400).send("Dados incompletos");let l=await (0,s.c)("artigos"),d=l.find(e=>e.id===r),c=(0,i.v4)(),p={id:c,article_id:r,articleName:d?.name||"",supplier:d?.supplier||"",width:d?.width||"",initial_quantity:Number(a),remaining_quantity:Number(a),lot_number:n||"",location:o||"",nuance:u||"",created_at:new Date().toISOString()},m=await (0,s.c)("rolls");return m.push(p),await (0,s.P)("rolls",m),t.json(p)}if("GET"===e.method){let{barcode:r}=e.query;if(!r)return t.status(400).send("Missing");let a=await (0,s.c)("rolls"),i=a.find(e=>e.id===r);if(i)return t.json(i);return t.status(404).send("Not found")}t.status(405).end()}catch(e){console.error(e),t.status(500).send("Erro")}}[i,s]=n.then?(await n)():n,a()}catch(e){a(e)}})}};var t=require("../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[222,924],()=>__webpack_exec__(3027));module.exports=r})();