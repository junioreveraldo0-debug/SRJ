"use strict";(()=>{var e={};e.id=908,e.ids=[908],e.modules={8432:e=>{e.exports=require("bcryptjs")},9344:e=>{e.exports=require("jsonwebtoken")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},1721:e=>{e.exports=import("@upstash/redis")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},1686:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{config:()=>p,default:()=>d,routeModule:()=>c});var a=t(1802),o=t(7153),n=t(6249),i=t(8165),u=e([i]);i=(u.then?(await u)():u)[0];let d=(0,n.l)(i,"default"),p=(0,n.l)(i,"config"),c=new a.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/auth/login",pathname:"/api/auth/login",bundlePath:"",filename:""},userland:i});s()}catch(e){s(e)}})},8165:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{default:()=>handler});var a=t(3924),o=t(8432),n=t.n(o),i=t(9344),u=t.n(i),d=e([a]);async function handler(e,r){if("POST"!==e.method)return r.status(405).json({error:"M\xe9todo n\xe3o permitido"});let{username:t,password:s}=e.body||{};if(!t||!s)return r.status(400).json({error:"Usu\xe1rio e senha obrigat\xf3rios"});let o=await (0,a.c)("users"),i=o.find(e=>e.username===t);if(!i)return r.status(401).json({error:"Usu\xe1rio n\xe3o encontrado"});let d=await n().compare(s,i.password);if(!d)return r.status(401).json({error:"Senha incorreta"});let p=u().sign({username:t},process.env.JWT_SECRET||"devsecret",{expiresIn:"6h"});return r.json({message:"ok",token:p,role:i.role||"user"})}a=(d.then?(await d)():d)[0],s()}catch(e){s(e)}})}};var r=require("../../../webpack-api-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[222,924],()=>__webpack_exec__(1686));module.exports=t})();